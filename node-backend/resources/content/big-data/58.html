<div>
    <span><div><b>Docker-Compose File</b></div><div>A simple docker-compose for creating Kafka with 2 brokers under 1 zookeeper:</div><div
            style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div>version: '2'</div><div>services:</div><div>    zookeeper:</div><div>        image: wurstmeister/zookeeper</div><div>        ports:</div><div>            - &quot;2181:2181&quot;</div><div>    kafka:</div><div>        image: wurstmeister/kafka</div><div>        ports:</div><div>        - &quot;9092:9092&quot;</div><div>        environment:</div><div>            KAFKA_ADVERTISED_HOST_NAME: 192.168.99.100</div><div>            KAFKA_CREATE_TOPICS: &quot;first_topic:3:2&quot;</div><div>            KAFKA_ZOOKEEPER_CONNECT: zookeeper:2181</div><div>        volumes:</div><div>        - /var/run/docker.sock:/var/run/docker.sock</div><div>    kafka_2:</div><div>        image: wurstmeister/kafka</div><div>        ports:</div><div>        - &quot;9093:9092&quot;</div><div>        environment:</div><div>            KAFKA_ADVERTISED_HOST_NAME: 192.168.99.100</div><div>            KAFKA_ZOOKEEPER_CONNECT: zookeeper:2181</div><div>        volumes:</div><div>            - /var/run/docker.sock:/var/run/docker.sock</div><div><br/></div></div><div><span
            style="box-sizing: border-box; font-size: 13.6px; word-wrap: normal; overflow: visible; border-radius: 3px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background: transparent; word-break: normal; white-space: pre; border: 0px;"><span
            style="background-color: transparent; color: rgb(36, 41, 46); font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-size: 13.6px; font-variant-caps: normal; font-variant-ligatures: normal; line-height: 1.45; font-weight: bold;">Breakdown</span></span></div><div><ul><li><font
            style="font-size: 10pt;">zookeeper - zookeeper is in charge of leader election, and coordinating brokers</font><br/></li><ul><li><font
            style="font-size: 10pt;">Generally Kafka usually run under a zookeeper, and won't work without one</font></li><li><font
            style="font-size: 10pt;">Zookeeper makes sure that there is always a leader for the brokers, and monitors them</font></li></ul><li><span
            style="font-size: 13.3333px;">Kafka environment:</span></li><ul><li>KAFKA_CREATE_TOPICS - creates a topic on startup with this format: &lt;topic_name&gt;:&lt;no_of_partition&gt;:&lt;replication_factor&gt;</li><ul><li>Just by specifying replication factor, and with enough brokers, zookeeper handles the rest. This helps with your application's resiliency as it is not dependent in one messaging broker alone</li></ul><li>KAFKA_ZOOKEEPER_CONNECT - which zookeeper to connect to</li><li>KAFKA_ADVERTISED_HOST_NAME - host name/ip</li></ul><li>Second Kafka is named kafka_2</li><ul><li>Notice that under ports, we use a different port number</li><li>and that we do note create the topic anymore under environment, but connects to the same zookeeper</li></ul></ul></div><div><span
            style="font-weight: bold;"><br/></span></div><div><br/></div><div><span style="font-weight: bold;">Ensuring Replication is done:</span></div><div
            style="box-sizing: border-box; padding: 8px; font-family: Monaco, Menlo, Consolas, &quot;Courier New&quot;, monospace; font-size: 12px; color: rgb(51, 51, 51); border-radius: 4px; background-color: rgb(251, 250, 248); border: 1px solid rgba(0, 0, 0, 0.15);-en-codeblock:true;"><div><span
            style="background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; font-size: 13.6px; word-wrap: normal; overflow: visible; border-radius: 3px; word-break: normal; white-space: pre; border: 0px;">./kafka-console-consumer.sh --bootstrap-server 192.168.99.100:9092 --topic first-topic --from-beginning</span></div><div><span
            style="background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; font-size: 13.6px; word-wrap: normal; overflow: visible; border-radius: 3px; word-break: normal; white-space: pre; border: 0px;">./kafka-console-consumer.sh --bootstrap-server 192.168.99.100:9093 --topic first-topic --from-beginning</span></div></div><div><br/></div><div><b>NOTES</b>: Even if we did not create the topic on the second kafka, we can list out the messages from the 2nd kafka service, this is because we have a replication factor of 2 when we created the topic. Zookeeper is then in charge of picking which kafka broker to replicate the topic to, and since we only have 2 brokers in this instance we can instantly find that the messages are replicated in both brokers.</div><div><span
            style="background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; font-size: 13.6px; word-wrap: normal; overflow: visible; border-radius: 3px; word-break: normal; white-space: pre; border: 0px;">  </span><span
            style="background-image: initial; background-position: initial; background-size: initial; background-repeat: initial; background-attachment: initial; background-origin: initial; background-clip: initial; font-size: 13.6px; word-wrap: normal; overflow: visible; border-radius: 3px; word-break: normal; white-space: pre; border: 0px;">  </span></div><div><span
            style="box-sizing: border-box; font-size: 13.6px; word-wrap: normal; overflow: visible; border-radius: 3px; letter-spacing: normal; orphans: 2; text-indent: 0px; text-transform: none; widows: 2; word-spacing: 0px; -webkit-text-stroke-width: 0px; background: transparent; word-break: normal; white-space: pre; border: 0px; color: rgb(36, 41, 46); font-family: SFMono-Regular, Consolas, &quot;Liberation Mono&quot;, Menlo, Courier, monospace; font-variant-caps: normal; font-variant-ligatures: normal; line-height: 1.45;"><b>Possible UI:</b></span></div><div><ul><li><font
            style="font-size: 10pt; font-family: SFMono-Regular; color: rgb(36, 41, 46);">Topics UI</font><br/></li><li><font
            style="font-size: 10pt; font-family: SFMono-Regular; color: rgb(36, 41, 46);">Schema UI</font></li><li><font
            style="font-size: 10pt; font-family: SFMono-Regular; color: rgb(36, 41, 46);">Connect UI</font></li><li><font
            style="font-size: 10pt; font-family: SFMono-Regular; color: rgb(36, 41, 46);">Kafka Manager</font></li><li><font
            style="font-size: 10pt; font-family: SFMono-Regular; color: rgb(36, 41, 46);">Burrow</font></li><li><font
            style="font-size: 10pt; font-family: SFMono-Regular; color: rgb(36, 41, 46);">Exhibitor</font></li><li><font
            style="font-size: 10pt; font-family: SFMono-Regular; color: rgb(36, 41, 46);">Kafka monitor</font></li><li><font
            style="font-size: 10pt; font-family: SFMono-Regular; color: rgb(36, 41, 46);">Kafka Tools</font></li><li><font
            style="font-size: 10pt; font-family: SFMono-Regular; color: rgb(36, 41, 46);">Kafkat</font></li></ul></div><div><br/></div><div><br/></div></span>
</div>